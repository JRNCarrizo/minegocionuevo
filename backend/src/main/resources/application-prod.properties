# ===========================================
# CONFIGURACIÓN DE PRODUCCIÓN - OPTIMIZADA
# ===========================================

# Configuración de la aplicación
spring.application.name=Negocio360-Backend-Produccion
spring.profiles.active=prod

# ===========================================
# OPTIMIZACIONES DE RENDIMIENTO
# ===========================================

# Configuración de JPA/Hibernate optimizada
spring.jpa.properties.hibernate.connection.pool_size=20
spring.jpa.properties.hibernate.connection.auto-commit=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.ehcache.EhCacheRegionFactory

# Configuración de conexiones de base de datos
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# Configuración de logs optimizada para producción
logging.level.root=WARN
logging.level.com.minegocio=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.boot.web.embedded.tomcat=WARN
logging.level.org.springframework.boot.autoconfigure.web=WARN
logging.level.org.springframework.cache=WARN

# Configuración de cache
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=500,expireAfterWrite=600s

# Configuración de servidor optimizada
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.tomcat.max-connections=8192
server.tomcat.accept-count=100
server.tomcat.connection-timeout=20000

# Configuración de compresión
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# Configuración de archivos optimizada
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.file-size-threshold=2KB

# Configuración de Jackson optimizada
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false

# Configuración de seguridad optimizada
spring.security.basic.enabled=false
spring.security.csrf.enabled=true

# Configuración de métricas (solo las esenciales)
management.metrics.enable.process=false
management.metrics.enable.system=false
management.metrics.enable.jvm=false
management.metrics.enable.processor=false
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# Configuración de templates (cache habilitado)
spring.thymeleaf.cache=true
spring.freemarker.cache=true
spring.groovy.template.cache=true

# Configuración de JWT
minegocio.app.jwtSecret=${JWT_SECRET:Negocio360SecretKeyParaJWT2024DeProduccionSuperSeguroConAlMenos64CaracteresParaHS512}
minegocio.app.jwtExpirationMs=86400000

# Configuración de archivos de upload
minegocio.app.upload.dir=/tmp/uploads/
minegocio.app.upload.images.dir=/tmp/uploads/images/
minegocio.app.upload.logos.dir=/tmp/uploads/logos/

# Configuración de email
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Configuración de la aplicación
minegocio.app.frontend.url=${FRONTEND_URL:https://negocio360.vercel.app}
minegocio.app.nombre=Negocio360
minegocio.app.email.from=${MAIL_FROM:noreply@negocio360.com}

# Configuración de servidor
server.address=0.0.0.0
server.port=${PORT:8080}
server.servlet.context-path=/

# Configuración de base de datos (usar variables de entorno)
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.jpa.database-platform=${SPRING_JPA_DATABASE_PLATFORM}
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO}
spring.jpa.show-sql=false

# Deshabilitar H2 completamente
spring.h2.console.enabled=false
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration

# Configuración SQL
spring.jpa.defer-datasource-initialization=false
spring.sql.init.mode=never
